import{b as A,f as L,g as O,h as R,i as j,j as G,m as H,n as z,o as q,q as J}from"./chunk-D7OGTJNG.js";import{$ as P,$a as g,Bb as N,C as E,F as S,Fa as C,Ha as _,I as p,Ia as s,Ib as k,J as u,Lb as U,Sa as B,Sb as F,Vb as D,Wa as r,Xa as M,Ya as x,Za as w,_a as c,aa as a,ab as f,ga as b,jb as T,ka as I,oa as V,wa as h,xa as n,ya as t,za as W}from"./chunk-JXKQ7VXO.js";import{a as y}from"./chunk-ODN5LVDJ.js";var v=class m{constructor(d){this.http=d}apiUrl="https://unpostsicuro.onrender.com/users";getProfile(d){return this.http.get(`${this.apiUrl}/${d}`)}updateProfile(d,e){return this.http.patch(`${this.apiUrl}/${d}`,e)}static \u0275fac=function(e){return new(e||m)(S(U))};static \u0275prov=E({token:m,factory:m.\u0275fac,providedIn:"root"})};function Y(m,d){if(m&1&&(n(0,"p",9),r(1),t()),m&2){let e=s();a(),M(e.error)}}function Z(m,d){if(m&1){let e=C();n(0,"div",10)(1,"form",11)(2,"div",12)(3,"div")(4,"label",13),r(5,"Nome"),t(),n(6,"input",14),f("ngModelChange",function(i){p(e);let o=s();return g(o.editModel.name,i)||(o.editModel.name=i),u(i)}),t()(),n(7,"div")(8,"label",13),r(9,"Cognome"),t(),n(10,"input",15),f("ngModelChange",function(i){p(e);let o=s();return g(o.editModel.surname,i)||(o.editModel.surname=i),u(i)}),t()()(),n(11,"div")(12,"label",13),r(13,"Email"),t(),n(14,"input",16),f("ngModelChange",function(i){p(e);let o=s();return g(o.editModel.email,i)||(o.editModel.email=i),u(i)}),t()(),n(15,"div",12)(16,"div")(17,"label",13),r(18,"Data di nascita"),t(),n(19,"input",17),f("ngModelChange",function(i){p(e);let o=s();return g(o.editModel.dob,i)||(o.editModel.dob=i),u(i)}),t()(),n(20,"div")(21,"label",13),r(22,"Genere"),t(),n(23,"select",18),f("ngModelChange",function(i){p(e);let o=s();return g(o.editModel.gender,i)||(o.editModel.gender=i),u(i)}),n(24,"option",19),r(25,"Seleziona..."),t(),n(26,"option",20),r(27,"Maschile"),t(),n(28,"option",21),r(29,"Femminile"),t(),n(30,"option",22),r(31,"Altro"),t()()()(),n(32,"div")(33,"label",13),r(34,"Telefono"),t(),n(35,"input",23),f("ngModelChange",function(i){p(e);let o=s();return g(o.editModel.phone,i)||(o.editModel.phone=i),u(i)}),t()(),n(36,"div")(37,"label",13),r(38,"Citt\xE0"),t(),n(39,"input",24),f("ngModelChange",function(i){p(e);let o=s();return g(o.editModel.city,i)||(o.editModel.city=i),u(i)}),t()(),n(40,"div")(41,"label",13),r(42,"Bio"),t(),n(43,"textarea",25),f("ngModelChange",function(i){p(e);let o=s();return g(o.editModel.bio,i)||(o.editModel.bio=i),u(i)}),t()(),n(44,"div",26)(45,"button",27),_("click",function(){p(e);let i=s();return u(i.saveProfile())}),r(46," \u{1F4BE} Salva "),t(),n(47,"button",28),_("click",function(){p(e);let i=s();return u(i.cancelEdit())}),r(48," \u2716 Annulla "),t()()()()}if(m&2){let e=s();a(6),c("ngModel",e.editModel.name),a(4),c("ngModel",e.editModel.surname),a(4),c("ngModel",e.editModel.email),a(5),c("ngModel",e.editModel.dob),a(4),c("ngModel",e.editModel.gender),a(12),c("ngModel",e.editModel.phone),a(4),c("ngModel",e.editModel.city),a(4),c("ngModel",e.editModel.bio)}}function $(m,d){if(m&1){let e=C();n(0,"div",10)(1,"div",29)(2,"p")(3,"span",30),r(4,"Nome"),t(),r(5),t(),n(6,"p")(7,"span",30),r(8,"Email"),t(),r(9),t(),n(10,"p")(11,"span",30),r(12,"Data di nascita"),t(),r(13),t(),n(14,"p")(15,"span",30),r(16,"Genere"),t(),r(17),t(),n(18,"p")(19,"span",30),r(20,"Telefono"),t(),r(21),t(),n(22,"p")(23,"span",30),r(24,"Citt\xE0"),t(),r(25),t()(),n(26,"div")(27,"span",30),r(28,"Bio"),t(),n(29,"p",31),r(30),t()(),n(31,"div",26)(32,"button",32),_("click",function(){p(e);let i=s();return u(i.enableEdit())}),r(33," Modifica Profilo "),t(),n(34,"button",33),_("click",function(){p(e);let i=s();return u(i.logout())}),r(35," Logout "),t()()()}if(m&2){let e=s();a(5),w(" ",e.user==null?null:e.user.name," ",e.user==null?null:e.user.surname),a(4),x(" ",e.user==null?null:e.user.email),a(4),x(" ",(e.user==null?null:e.user.dob)||"Non specificata"),a(4),x(" ",(e.user==null?null:e.user.gender)||"Non specificato"),a(4),x(" ",(e.user==null?null:e.user.phone)||"Non specificato"),a(4),x(" ",(e.user==null?null:e.user.city)||"Non specificata"),a(5),M((e.user==null?null:e.user.bio)||"Nessuna bio disponibile")}}var K=class m{constructor(d,e){this.profileService=d;this.router=e}user;loading=!0;error;editing=!1;editModel={};ngOnInit(){this.loadProfile()}get userId(){return localStorage.getItem("userId")}loadProfile(){if(this.loading=!0,this.error=void 0,!this.userId){this.error="Utente non autenticato",this.loading=!1;return}this.profileService.getProfile(this.userId).subscribe({next:d=>{this.user=d,this.resetEditModel(),this.loading=!1},error:d=>{console.error("Errore caricamento profilo",d),this.error="Impossibile caricare il profilo. Riprova pi\xF9 tardi.",this.loading=!1}})}resetEditModel(){this.user&&(this.editModel=y({},this.user))}enableEdit(){this.editing=!0,this.resetEditModel()}cancelEdit(){this.editing=!1,this.resetEditModel()}saveProfile(){this.userId&&this.profileService.updateProfile(this.userId,this.editModel).subscribe({next:d=>{this.user=d,this.editing=!1},error:d=>{console.error("Errore salvataggio profilo",d),this.error="Errore durante il salvataggio. Riprova."}})}logout(){localStorage.removeItem("userId"),this.router.navigate(["/login"])}goTo(d){this.router.navigate([d])}static \u0275fac=function(e){return new(e||m)(b(v),b(F))};static \u0275cmp=I({type:m,selectors:[["app-profile"]],decls:12,vars:7,consts:[["profileView",""],[1,"min-h-screen","bg-gradient-to-br","from-[#FAFAFA]","to-[#E6F6F6]"],[1,"bg-gradient-to-r","from-[#5EADB1]","to-[#60BFB6]","p-10","text-center","text-white","shadow-lg"],["alt","Avatar",1,"w-32","h-32","mx-auto","rounded-full","border-4","border-white","shadow-lg","ring-4","ring-[#ffffff40]","mb-4",3,"src"],[1,"text-3xl","font-bold"],[1,"text-lg","opacity-90"],[1,"max-w-5xl","mx-auto","py-12","px-6"],["class","text-red-500 text-center mb-6",4,"ngIf"],["class","space-y-8",4,"ngIf","ngIfElse"],[1,"text-red-500","text-center","mb-6"],[1,"space-y-8"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","text-gray-600","mb-1"],["name","name",1,"input-field","w-full",3,"ngModelChange","ngModel"],["name","surname",1,"input-field","w-full",3,"ngModelChange","ngModel"],["name","email",1,"input-field","w-full",3,"ngModelChange","ngModel"],["type","date","name","dob",1,"input-field","w-full",3,"ngModelChange","ngModel"],["name","gender",1,"input-field","w-full",3,"ngModelChange","ngModel"],["value",""],["value","male"],["value","female"],["value","other"],["name","phone",1,"input-field","w-full",3,"ngModelChange","ngModel"],["name","city",1,"input-field","w-full",3,"ngModelChange","ngModel"],["name","bio",1,"input-field","w-full","h-24",3,"ngModelChange","ngModel"],[1,"flex","justify-center","gap-4","mt-8"],["type","button",1,"flex","items-center","gap-2","bg-[#5EADB1]","text-white","font-semibold","py-2","px-6","rounded-lg","hover:bg-[#60BFB6]","transition",3,"click"],["type","button",1,"flex","items-center","gap-2","bg-gray-200","text-gray-800","font-semibold","py-2","px-6","rounded-lg","hover:bg-gray-300","transition",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","text-gray-800"],[1,"block","text-sm","text-gray-500"],[1,"italic","text-gray-700"],[1,"flex","items-center","gap-2","bg-[#5EADB1]","text-white","font-semibold","py-2","px-6","rounded-lg","hover:bg-[#60BFB6]","transition",3,"click"],[1,"flex","items-center","gap-2","bg-gray-200","text-gray-800","font-semibold","py-2","px-6","rounded-lg","hover:bg-gray-300","transition",3,"click"]],template:function(e,l){if(e&1&&(n(0,"div",1)(1,"header",2),W(2,"img",3),n(3,"h1",4),r(4),t(),n(5,"h2",5),r(6),t()(),n(7,"main",6),V(8,Y,2,1,"p",7)(9,Z,49,8,"div",8)(10,$,36,8,"ng-template",null,0,T),t()()),e&2){let i=B(11);a(2),h("src",(l.user==null?null:l.user.avatar_url)||"assets/img/user.png",P),a(2),w("",l.user==null?null:l.user.name," ",l.user==null?null:l.user.surname),a(2),M(l.user==null?null:l.user.email),a(2),h("ngIf",l.error),a(),h("ngIf",l.editing)("ngIfElse",i)}},dependencies:[k,N,J,G,z,q,A,H,L,O,j,R,D],encapsulation:2})};export{K as ProfileComponent};

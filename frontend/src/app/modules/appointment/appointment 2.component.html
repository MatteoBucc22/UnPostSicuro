<div *ngIf="specialistId && userId" class="relative p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
  <h3 class="text-2xl font-bold text-[#5EADB1] mb-4">📅 Seleziona una data</h3>

  <mat-form-field appearance="fill" class="w-full mb-6">
    <input matInput [matDatepicker]="picker" [(ngModel)]="selectedDate" placeholder="Scegli una data" (dateChange)="onDateChange()">
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker touchUi="true"></mat-datepicker>
  </mat-form-field>

  <div *ngIf="selectedDate && allSlots.length > 0">
    <h4 class="text-lg font-semibold text-gray-700 mb-2">Seleziona un orario disponibile</h4>
    <div class="grid grid-cols-3 gap-4">
      <button
        *ngFor="let slot of allSlots"
        (click)="onSlotClick(slot)"
        [disabled]="!availableSlots.includes(slot)"
        [ngClass]="{
          'bg-[#5EADB1] text-white': selectedTime === slot,
          'border border-gray-300 text-gray-400 cursor-not-allowed': !availableSlots.includes(slot),
          'border border-gray-300 text-gray-800': selectedTime !== slot && availableSlots.includes(slot)
        }"
        class="rounded-xl p-3 hover:scale-105 hover:shadow-lg transition-all text-center font-medium">
        {{ slot }}
      </button>
    </div>
  </div>

  <div *ngIf="selectedDate && availableSlots.length === 0" class="text-gray-500 mt-2">
    Nessun orario disponibile per questa data.
  </div>

  <div *ngIf="pendingAppointmentId && timerSeconds! > 0" class="mt-4 text-gray-700 font-medium">
    ⏳ Tempo rimasto per completare il pagamento: 
    {{ (timerSeconds! / 60) | number:'1.0-0' }} min {{ (timerSeconds! % 60) | number:'2.0-0' }} sec
  </div>

  <button
    (click)="bookAppointment()"
    [disabled]="!selectedDate || !selectedTime"
    class="mt-6 w-full bg-[#5EADB1] text-white font-semibold py-3 rounded-xl hover:bg-[#4c9397] transition-all shadow-md disabled:bg-gray-300">
    Prenota Appuntamento
  </button>
</div>
